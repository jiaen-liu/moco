function mat=quaternion_to_rotmat(quat)
% compute the rotation matrix
mat=[quat(1)*quat(1)+quat(2)*quat(2)-quat(3)*quat(3)-quat(4)*quat(4),...
     2.0*quat(2)*quat(3)-2.0*quat(1)*quat(4),...
     2.0*quat(2)*quat(4)+2.0*quat(1)*quat(3);...
     2.0*quat(2)*quat(3)+2.0*quat(1)*quat(4),...
     quat(1)*quat(1)-quat(2)*quat(2)+quat(3)*quat(3)-quat(4)*quat(4),...
     2.0*quat(3)*quat(4)-2.0*quat(1)*quat(2);...
     2.0*quat(2)*quat(4)-2.0*quat(1)*quat(3),...
     2.0*quat(3)*quat(4)+2.0*quat(1)*quat(2),...
     quat(1)*quat(1)-quat(2)*quat(2)-quat(3)*quat(3)+quat(4)*quat(4)].';

end
